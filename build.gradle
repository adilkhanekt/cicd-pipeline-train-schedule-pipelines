plugins {
  //inlude the nodeJS plugin to execute nodejs and npm tasks
  id "com.moowork.node" version "1.2.0"
}

node {
	download = true
	version = "9.11.1"
	npmVersion = "5.6.0"
}

//declare a build task
tasks.register('build') {
    dependsOn('npm_build')
    dependsOn('zip')
}

//declare a task to create a zip of the app
tasks.register('zip', Zip) {
    dependsOn('npm_build')
    description 'Archives package'
    from '.'
    include('*', 'bin/**', 'data/**', 'node_modules/**', 'public/**', 'routes/**', 'views/**')
    archiveName 'trainschedule.zip'
    destinationDir(file('dist'))
}

//declare task dependencies
tasks.named('npm_build') { dependsOn ('npmInstall', 'npm_test') } 